@page "/"
@using kreddit_app.Data
@using shared.Model
@inject ApiService apiService

<PostForm OnPostCreated="HandlePostCreated" />
<PostsList posts="posts" />

@code {
    private List<Post> posts = new List<Post>();

    protected override async Task OnInitializedAsync()
    {
        posts = (await apiService.GetAllPostsAsync()).ToList();
    }

    private async Task HandlePostCreated(Post newPost)
    {
        try
        {
            var createdPost = await apiService.CreatePostAsync(newPost);
            posts.Insert(0, createdPost); // Tilføj den nye post til toppen
            StateHasChanged(); 
        }
        catch (Exception ex)
        {
            Console.Error.WriteLine($"Fejl ved oprettelse af post: {ex.Message}");
        }
    }
}
